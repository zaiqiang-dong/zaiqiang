(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{478:function(a,s,e){"use strict";e.r(s);var n=e(28),t=Object(n.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"页面分配基本流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#页面分配基本流程"}},[a._v("#")]),a._v(" 页面分配基本流程")]),a._v(" "),e("hr"),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("软件版本")]),a._v(" "),e("th",[a._v("硬件版本")]),a._v(" "),e("th",[a._v("更新内容")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("linux 5.8.18")]),a._v(" "),e("td",[a._v("arm64")]),a._v(" "),e("td")])])]),a._v(" "),e("hr"),a._v(" "),e("p",[a._v("本章只是梳理页面分配流程，不存在代码思想的解析。")]),a._v(" "),e("h2",{attrs:{id:"_1-接口函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-接口函数"}},[a._v("#")]),a._v(" 1. 接口函数")]),a._v(" "),e("h3",{attrs:{id:"_1-1-alloc-page"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-alloc-page"}},[a._v("#")]),a._v(" 1.1 alloc_page")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#define alloc_page(gfp_mask) alloc_pages(gfp_mask, 0)\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("从代码可以看出"),e("code",[a._v("alloc_page")]),a._v("最终调用的是"),e("code",[a._v("alloc_pages")]),a._v(",只是在第二个参数的位置写0,表示 "),e("mjx-container",{staticClass:"MathJax",attrs:{jax:"SVG"}},[e("svg",{staticStyle:{"vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2.044ex",height:"1.887ex",viewBox:"0 -833.9 903.6 833.9"}},[e("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"matrix(1 0 0 -1 0 0)"}},[e("g",{attrs:{"data-mml-node":"math"}},[e("g",{attrs:{"data-mml-node":"msup"}},[e("g",{attrs:{"data-mml-node":"mn"}},[e("path",{attrs:{"data-c":"32",d:"M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"}})]),e("g",{attrs:{"data-mml-node":"mn",transform:"translate(500, 363) scale(0.707)"}},[e("path",{attrs:{"data-c":"30",d:"M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"}})])])])])])]),a._v(",也就是1个页面。")],1),a._v(" "),e("h3",{attrs:{id:"_1-2-get-free-pages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-get-free-pages"}},[a._v("#")]),a._v(" 1.2 __get_free_pages")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("unsigned long __get_free_pages(gfp_t gfp_mask, unsigned int order)\n{\n\tstruct page *page;\n\n\tpage = alloc_pages(gfp_mask & ~__GFP_HIGHMEM, order);\n\tif (!page)\n\t\treturn 0;\n\treturn (unsigned long) page_address(page);\n}\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br")])]),e("p",[a._v("同样的"),e("code",[a._v("__get_free_pages")]),a._v("也是调用了调用了"),e("code",[a._v("alloc_pages")]),a._v(",只是在"),e("code",[a._v("gfp_mask")]),a._v("参数部分清除了"),e("code",[a._v("__GFP_HIGHMEM")]),a._v(",也就是不能从高端内存部分分配。这里最后一行"),e("code",[a._v("page_address")]),a._v(",表示返回的是页面的虚拟地址。")]),a._v(" "),e("h3",{attrs:{id:"_1-3-get-free-page"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-get-free-page"}},[a._v("#")]),a._v(" 1.3 __get_free_page")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#define __get_free_page(gfp_mask) \\\n\t\t__get_free_pages((gfp_mask), 0)\n\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br")])]),e("p",[a._v("这个很明显调用了"),e("code",[a._v("__get_free_pages")]),a._v(",只是页面个数为1.")]),a._v(" "),e("h3",{attrs:{id:"_1-4-get-zeroed-page"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-get-zeroed-page"}},[a._v("#")]),a._v(" 1.4 get_zeroed_page")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("unsigned long get_zeroed_page(gfp_t gfp_mask)\n{\n\treturn __get_free_pages(gfp_mask | __GFP_ZERO, 0);\n}\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("p",[a._v("这个函数调用了上面的"),e("code",[a._v("__get_free_pages")]),a._v(",只是设置了"),e("code",[a._v("__GFP_ZERO")]),a._v(",表示需要将页面进行清0处理。另外页面个数部分为0,表示只分配一个页面。")]),a._v(" "),e("h3",{attrs:{id:"_1-5-get-dma-pages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-get-dma-pages"}},[a._v("#")]),a._v(" 1.5 __get_dma_pages")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#define __get_dma_pages(gfp_mask, order) \\\n\t\t__get_free_pages((gfp_mask) | GFP_DMA, (order))\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("这里同样调用了"),e("code",[a._v("__get_free_pages")]),a._v(",只是设置了"),e("code",[a._v("GFP_DMA")]),a._v(",表示从DMA内存分区进行内存分配。")]),a._v(" "),e("h2",{attrs:{id:"_2-alloc-pages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-alloc-pages"}},[a._v("#")]),a._v(" 2. alloc_pages")]),a._v(" "),e("p",[a._v("从上面的接口分析中可以看出所有的接口最终都是调用了"),e("code",[a._v("alloc_pages")]),a._v(",下面我重点分析这个函数。")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#ifdef CONFIG_NUMA\nextern struct page *alloc_pages_current(gfp_t gfp_mask, unsigned order);\n\nstatic inline struct page *\nalloc_pages(gfp_t gfp_mask, unsigned int order)\n{\n\treturn alloc_pages_current(gfp_mask, order);\n}\nextern struct page *alloc_pages_vma(gfp_t gfp_mask, int order,\n\t\t\tstruct vm_area_struct *vma, unsigned long addr,\n\t\t\tint node, bool hugepage);\n#define alloc_hugepage_vma(gfp_mask, vma, addr, order) \\\n\talloc_pages_vma(gfp_mask, order, vma, addr, numa_node_id(), true)\n#else\n#define alloc_pages(gfp_mask, order) \\\n\t\talloc_pages_node(numa_node_id(), gfp_mask, order)\n#define alloc_pages_vma(gfp_mask, order, vma, addr, node, false)\\\n\talloc_pages(gfp_mask, order)\n#define alloc_hugepage_vma(gfp_mask, vma, addr, order) \\\n\talloc_pages(gfp_mask, order)\n#endif\n\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br")])]),e("p",[a._v("从宏定义可以看出在"),e("code",[a._v("NUMA")]),a._v("和非"),e("code",[a._v("NUMA")]),a._v(",存在不同，我们这里按非"),e("code",[a._v("NUMA")]),a._v("来分析。也就是如下：")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#define alloc_pages(gfp_mask, order) \\\n\t\talloc_pages_node(numa_node_id(), gfp_mask, order)\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("最终调用的是"),e("code",[a._v("alloc_pages_node")]),a._v(",这里的node是"),e("code",[a._v("NUMA")]),a._v("节点。这里"),e("code",[a._v("numa_node_id")]),a._v("返回的是当前"),e("code",[a._v("CPU")]),a._v("所在的"),e("code",[a._v("NUMA")]),a._v("节点，我们这里是讨论的是非"),e("code",[a._v("NUMA")]),a._v("平台，所以这里的节点值为0。")]),a._v(" "),e("h3",{attrs:{id:"_2-1-alloc-pages-node"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-alloc-pages-node"}},[a._v("#")]),a._v(" 2.1 alloc_pages_node")]),a._v(" "),e("p",[a._v("从上面的分析最终是调用了"),e("code",[a._v("alloc_pages_node")]),a._v(",代码如下：")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("static inline struct page *alloc_pages_node(int nid, gfp_t gfp_mask,\n\t\t\t\t\t\tunsigned int order)\n{\n\tif (nid == NUMA_NO_NODE)\n\t\tnid = numa_mem_id();\n\n\treturn __alloc_pages_node(nid, gfp_mask, order);\n}\n\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br")])]),e("p",[a._v("代码很简单就是调用"),e("code",[a._v("__alloc_pages_node")])]),a._v(" "),e("h3",{attrs:{id:"_2-2-alloc-pages-node"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-alloc-pages-node"}},[a._v("#")]),a._v(" 2.2 __alloc_pages_node")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("static inline struct page *\n__alloc_pages_node(int nid, gfp_t gfp_mask, unsigned int order)\n{\n\t/* 保证nid的合法性 */\n\tVM_BUG_ON(nid < 0 || nid >= MAX_NUMNODES);\n\tVM_WARN_ON((gfp_mask & __GFP_THISNODE) && !node_online(nid));\n\n\treturn __alloc_pages(gfp_mask, order, nid);\n}\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br")])]),e("h3",{attrs:{id:"_2-3-alloc-pages"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-alloc-pages"}},[a._v("#")]),a._v(" 2.3 __alloc_pages")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("struct page *\n__alloc_pages_nodemask(gfp_t gfp_mask, unsigned int order, int preferred_nid,\n\t\t\t\t\t\t\tnodemask_t *nodemask);\n\nstatic inline struct page *\n__alloc_pages(gfp_t gfp_mask, unsigned int order, int preferred_nid)\n{\n\treturn __alloc_pages_nodemask(gfp_mask, order, preferred_nid, NULL);\n}\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br")])]),e("p",[a._v("上面代码很简单，"),e("code",[a._v("__alloc_pages_nodemask")]),a._v("是真正的内存分配函数。")]),a._v(" "),e("h3",{attrs:{id:"_3-alloc-pages-nodemask"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-alloc-pages-nodemask"}},[a._v("#")]),a._v(" 3. __alloc_pages_nodemask")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("struct page *\n__alloc_pages_nodemask(gfp_t gfp_mask, unsigned int order, int preferred_nid,\n\t\t\t\t\t\t\tnodemask_t *nodemask)\n{\n\tstruct page *page;\n\tunsigned int alloc_flags = ALLOC_WMARK_LOW;\n\tgfp_t alloc_mask; /* The gfp_t that was actually used for allocation */\n\tstruct alloc_context ac = { };\n\n\t/*\n\t * There are several places where we assume that the order value is sane\n\t * so bail out early if the request is out of bound.\n\t */\n\tif (unlikely(order >= MAX_ORDER)) {\n\t\tWARN_ON_ONCE(!(gfp_mask & __GFP_NOWARN));\n\t\treturn NULL;\n\t}\n\n\t/*\n\t * gfp_allowed_mask 在系统启动中为GFP_BOOT_MASK\n\t * #define GFP_BOOT_MASK (__GFP_BITS_MASK & ~(__GFP_RECLAIM|__GFP_IO|__GFP_FS))\n\t *\n\t * 后设置为如下\n\t * gfp_allowed_mask = __GFP_BITS_MASK; = 0x7FFFFF;\n\t *\n\t */\n\tgfp_mask &= gfp_allowed_mask;\n\talloc_mask = gfp_mask;\n\t/*\n\t * prepare_alloc_pages 主要是初始化ac，具体见函数实现\n\t */\n\tif (!prepare_alloc_pages(gfp_mask, order, preferred_nid, nodemask, &ac, &alloc_mask, &alloc_flags))\n\t\treturn NULL;\n\t/*\n\t * 这里主要是要找一个最好的zone用于后面分配内存\n\t *\n\t * */\n\tfinalise_ac(gfp_mask, &ac);\n\n\t/*\n\t * Forbid the first pass from falling back to types that fragment\n\t * memory until all local zones are considered.\n\t */\n\talloc_flags |= alloc_flags_nofragment(ac.preferred_zoneref->zone, gfp_mask);\n\t/*\n\t * 大部分情况会走这里\n\t */\n\t/* First allocation attempt */\n\tpage = get_page_from_freelist(alloc_mask, order, alloc_flags, &ac);\n\tif (likely(page))\n\t\tgoto out;\n\n\t/*\n\t * Apply scoped allocation constraints. This is mainly about GFP_NOFS\n\t * resp. GFP_NOIO which has to be inherited for all allocation requests\n\t * from a particular context which has been marked by\n\t * memalloc_no{fs,io}_{save,restore}.\n\t */\n\talloc_mask = current_gfp_context(gfp_mask);\n\tac.spread_dirty_pages = false;\n\n\t/*\n\t * Restore the original nodemask if it was potentially replaced with\n\t * &cpuset_current_mems_allowed to optimize the fast-path attempt.\n\t */\n\tac.nodemask = nodemask;\n\t/*\n\t * 系统内存不足，先回收再分配\n\t */\n\n\tpage = __alloc_pages_slowpath(alloc_mask, order, &ac);\n\nout:\n\tif (memcg_kmem_enabled() && (gfp_mask & __GFP_ACCOUNT) && page &&\n\t    unlikely(__memcg_kmem_charge_page(page, gfp_mask, order) != 0)) {\n\t\t__free_pages(page, order);\n\t\tpage = NULL;\n\t}\n\n\ttrace_mm_page_alloc(page, order, alloc_mask, ac.migratetype);\n\n\treturn page;\n}\n\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br"),e("span",{staticClass:"line-number"},[a._v("25")]),e("br"),e("span",{staticClass:"line-number"},[a._v("26")]),e("br"),e("span",{staticClass:"line-number"},[a._v("27")]),e("br"),e("span",{staticClass:"line-number"},[a._v("28")]),e("br"),e("span",{staticClass:"line-number"},[a._v("29")]),e("br"),e("span",{staticClass:"line-number"},[a._v("30")]),e("br"),e("span",{staticClass:"line-number"},[a._v("31")]),e("br"),e("span",{staticClass:"line-number"},[a._v("32")]),e("br"),e("span",{staticClass:"line-number"},[a._v("33")]),e("br"),e("span",{staticClass:"line-number"},[a._v("34")]),e("br"),e("span",{staticClass:"line-number"},[a._v("35")]),e("br"),e("span",{staticClass:"line-number"},[a._v("36")]),e("br"),e("span",{staticClass:"line-number"},[a._v("37")]),e("br"),e("span",{staticClass:"line-number"},[a._v("38")]),e("br"),e("span",{staticClass:"line-number"},[a._v("39")]),e("br"),e("span",{staticClass:"line-number"},[a._v("40")]),e("br"),e("span",{staticClass:"line-number"},[a._v("41")]),e("br"),e("span",{staticClass:"line-number"},[a._v("42")]),e("br"),e("span",{staticClass:"line-number"},[a._v("43")]),e("br"),e("span",{staticClass:"line-number"},[a._v("44")]),e("br"),e("span",{staticClass:"line-number"},[a._v("45")]),e("br"),e("span",{staticClass:"line-number"},[a._v("46")]),e("br"),e("span",{staticClass:"line-number"},[a._v("47")]),e("br"),e("span",{staticClass:"line-number"},[a._v("48")]),e("br"),e("span",{staticClass:"line-number"},[a._v("49")]),e("br"),e("span",{staticClass:"line-number"},[a._v("50")]),e("br"),e("span",{staticClass:"line-number"},[a._v("51")]),e("br"),e("span",{staticClass:"line-number"},[a._v("52")]),e("br"),e("span",{staticClass:"line-number"},[a._v("53")]),e("br"),e("span",{staticClass:"line-number"},[a._v("54")]),e("br"),e("span",{staticClass:"line-number"},[a._v("55")]),e("br"),e("span",{staticClass:"line-number"},[a._v("56")]),e("br"),e("span",{staticClass:"line-number"},[a._v("57")]),e("br"),e("span",{staticClass:"line-number"},[a._v("58")]),e("br"),e("span",{staticClass:"line-number"},[a._v("59")]),e("br"),e("span",{staticClass:"line-number"},[a._v("60")]),e("br"),e("span",{staticClass:"line-number"},[a._v("61")]),e("br"),e("span",{staticClass:"line-number"},[a._v("62")]),e("br"),e("span",{staticClass:"line-number"},[a._v("63")]),e("br"),e("span",{staticClass:"line-number"},[a._v("64")]),e("br"),e("span",{staticClass:"line-number"},[a._v("65")]),e("br"),e("span",{staticClass:"line-number"},[a._v("66")]),e("br"),e("span",{staticClass:"line-number"},[a._v("67")]),e("br"),e("span",{staticClass:"line-number"},[a._v("68")]),e("br"),e("span",{staticClass:"line-number"},[a._v("69")]),e("br"),e("span",{staticClass:"line-number"},[a._v("70")]),e("br"),e("span",{staticClass:"line-number"},[a._v("71")]),e("br"),e("span",{staticClass:"line-number"},[a._v("72")]),e("br"),e("span",{staticClass:"line-number"},[a._v("73")]),e("br"),e("span",{staticClass:"line-number"},[a._v("74")]),e("br"),e("span",{staticClass:"line-number"},[a._v("75")]),e("br"),e("span",{staticClass:"line-number"},[a._v("76")]),e("br"),e("span",{staticClass:"line-number"},[a._v("77")]),e("br"),e("span",{staticClass:"line-number"},[a._v("78")]),e("br"),e("span",{staticClass:"line-number"},[a._v("79")]),e("br"),e("span",{staticClass:"line-number"},[a._v("80")]),e("br"),e("span",{staticClass:"line-number"},[a._v("81")]),e("br"),e("span",{staticClass:"line-number"},[a._v("82")]),e("br"),e("span",{staticClass:"line-number"},[a._v("83")]),e("br"),e("span",{staticClass:"line-number"},[a._v("84")]),e("br")])]),e("h2",{attrs:{id:"_4-小结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-小结"}},[a._v("#")]),a._v(" 4. 小结")]),a._v(" "),e("p",[a._v("本文只是梳理了大体的内存页面分配的思路，从上面代码分析中可以看到"),e("code",[a._v("__alloc_pages_nodemask")]),a._v("才是真正的分配函数，无论你调用了那个接口函数，最终都会调到这里。")]),a._v(" "),e("hr"),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),e("p",[a._v("欢迎评论、探讨,如果发现错误请指正。转载请注明出处！ "),e("a",{attrs:{href:"http://www.tsz.wiki",target:"_blank",rel:"noopener noreferrer"}},[a._v("探索者"),e("OutboundLink")],1)])]),a._v(" "),e("hr"),a._v(" "),e("Vssue",{attrs:{title:a.$title}})],1)}),[],!1,null,null,null);s.default=t.exports}}]);